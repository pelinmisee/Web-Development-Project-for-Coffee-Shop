
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apollo Coffee Shop</title>
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&display=swap');
        *{
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html    {
                height: 100%;
                }
                  
        body {
            font-family: Arial, Helvetica, sans-serif;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
             background-color: #FFF3E4;
                }
        
        
        
                header {
                    background-color: #6B4F4F  ;
                    color: #FFF3E4;
                    text-align: center;
                    padding: 1em;
        
                }
        
                nav {
                    background-color: #483434;
                    padding: 1em;
                    text-align: center;
                }
        
                nav a {
                    color: #FFF3E4;
                    text-decoration: none;
                    padding: 1em;
                    margin: 0 1em;
                }
        
                nav a:hover {
                    background-color: #EED6C4   ;
                    color: #483434;
                    text-decoration: underline;
                }
        
                section {
                    padding: 0;
                    text-align: center;
                    margin: 0;
                    box-sizing: border-box;
        
                }
        
                .section_h1 {
                    color: #483434;
                    font-size: 3em;
                    font-weight: bold;
                    margin-top: 40px;
                }
        
        
        
                p {
                    color: #483434;
                    font-size: 1.5em;
                    margin-top: 50px;
                }
                
                .logo {
                    width: 75px;
                    height: 75px;
                }   
        
                .add-coffee-form {
                    max-width: 400px;
                    margin: 20px auto;
                    padding: 20px;
                    background-color: #483434;
                    color: #EED6C4;
                    border: 1px solid #EED6C4;
                    border-radius: 8px;
                    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
                }
        
                label {
                    display: block;
                    margin-bottom: 8px;
                }
        
                input {
                    width: 100%;
                    padding: 8px;
                    margin-bottom: 16px;
                    box-sizing: border-box;
                    background-color: #EED6C4;
                    border: none;
                    border-radius: 40px;
                    
                }
        
                button {
                    background-color: #EED6C4;
                    color: #483434;
                    padding: 10px;
                    border: none;
                    border-radius: 4px;
                    cursor: pointer;
                    justify-content: center;
                    display: block;
                    margin: 0 auto;
                    width: 100px;
        
                    
                }

        
                button:hover {
                    background-color: #6B4F4F   ;
                    color: #483434;
                    text-decoration: underline;
                }

                .button-container {
                    display: flex;
                    justify-content: center;
                }
                
                .button-container button {
                    background-color: #EED6C4;
                    color: #483434;
                    padding: 10px;
                    border: none;
                    border-radius: 4px;
                    cursor: pointer;
                    width: 100px;
                    margin-bottom: 3px;
                }

                .button-container button:hover {
                    background-color: #6B4F4F   ;
                    color: #483434;
                    text-decoration: underline;
                }



                .main-title {
                    text-align: center;
                    margin-top: 40px;
                    color: #483434;
                    font-size: 3em;
                    font-weight: bold;
        
                }
        
                #logout{
                    background-color: #483434;
                    color: #FFF3E4;
                    cursor: pointer;
                    justify-content: center;
                    display: block;
                    width: 100px;
                    float:inline-end;
                    padding: 1.22em;
                    margin-top: -1%;
                
                }
        
                #logout:hover {
                    background-color: #EED6C4;
                    color: #483434;
                    text-decoration: underline;
        
                }
        
                select {
                    width: 100%;
                    padding: 8px;
                    margin-bottom: 16px;
                    box-sizing: border-box;
                    background-color: #EED6C4;
                    border: none;
                    border-radius: 40px;
                }


                #coffeeNumber {
                    width: 30%;
                    margin-left: 35%;
                    border: 1px solid #483434;
                    
                }

                #coffeeNumberP {
                    text-align: center;
                    font-size: 1.5em;
                    font-weight: bold;
                    margin-top: 40px;
                    color: #483434;
                }

                #ordertable {
                    font-family: Arial, sans-serif;
                    border-collapse: collapse;
                    width: 100%;
                }
            
                #ordertable th, #ordertable td {
                    border: 1px solid #ddd;
                    padding: 5px;
                    text-align: center;
                    white-space: nowrap; /* Prevent text wrapping */
                    overflow: hidden;
                    text-overflow: ellipsis;
                    width: 33%;
                }

                #ordertable td {
                    background-color: #EED6C4;
                    color: #483434;
                }

                #ordertable td:hover {
                    background-color: #6B4F4F;
                    color: #EED6C4;
                }
            
                #ordertable th {
                    background-color: #483434;
                    color: #FFF3E4;
                }

                footer {
                    position: fixed;
                    bottom: 0;
                    left: 0;
                    width: 100%;
                    height: 3rem;            /* Footer height */
                    background-color: #6B4F4F;
                    color: #EED6C4;
                    text-align: center;
                    
                }
                
                footer p {
                    padding: 1rem;
                    margin: 0;
                    color: #EED6C4;
                    font-size: smaller;
                }
            
               
            </style>
</head>

<body>
    <header>
        <img class="logo" src="..\logo.png" alt="" style="float: left; margin-left: 10px;">
        <h1>Apollo Coffee Shop

        </h1>
    </header>

        <nav>
            <a href="customer_main.html" >Home</a>
            <a href="customer_coffees.html" >Coffees</a>
            <a href="customer_orders.html" >Order History</a>
            <a href="customer_profile.html" >My Profile</a>
            <a href="customer_give_order.html" >Give Order</a>
            <button id="logout" type="button" onclick="logout()">Logout</button>
    
        </nav>
        <h1 class="main-title">Add Coffee to Your Order</h1>

        <div class="add-coffee-form">
            <form>
                <label for="coffee_name" >Coffee Name</label>
                <select name="coffee_name" id="coffee_name"></select>

                <label for="coffee_size" >Coffee Size</label>
                <select name="coffee_size" id="coffee_size">
                    <option value="Small">Small</option>
                    <option value="Medium">Medium</option>
                    <option value="Large" >Large</option> </select>
                
                <label for="quantity">How Many?</label>
                <select name="quantity" id="quantity"> </select>
                
                <button type="button" onclick="add_coffee_to_local_storage()">Add Coffee</button>
              </form>

        </div>

        <div class="button-container">
            <button type="button" onclick="go_to_order()">Go to Order</button>

            <p id="remain_coffee"> </p>
            
            <button type="button" onclick="cancel_order()">Cancel Order</button>
    </div>

        <br>
        
        <div id="coffee-list">

        </div>


    
    <script>     

        function go_to_order() {
            if (localStorage.getItem("total_order_quantity") == 0) {
                window.location.href = "customer_give_order3.html";
                return;
            }

            else {
                alert("You haven't added all the coffees you said.");
            }

        }

        function cancel_order() {
            localStorage.removeItem("total_order_quantity");
            localStorage.removeItem("coffee_list");
            window.location.href = "customer_give_order.html";
        }

        function add_coffee_to_local_storage() {

            var coffee_size = document.getElementById("coffee_size").value;
            var coffee_name = document.getElementById("coffee_name").value;
            var coffee_quantity = document.getElementById("quantity").value;
            var total_order_quantity = localStorage.getItem("total_order_quantity") - coffee_quantity;

            if (coffee_size == "" || coffee_name == "" || coffee_quantity == "") {
                alert("Please choose coffee size, coffee name and quantity.");
            }

            if (total_order_quantity < 0) {
                alert("You can't order more than you said.");
                return;
            }

        
            localStorage.setItem("total_order_quantity", total_order_quantity);
            
            var coffee_list = JSON.parse(localStorage.getItem("coffee_list"));
            if (coffee_list == null) {
                coffee_list = [];
             }
            //create a key value for coffee_list randomly a word with 10 characters
            const key = Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);

            coffee_list.push({ "key": key, "coffee_name": coffee_name, "coffee_size": coffee_size, "coffee_quantity": coffee_quantity });
            localStorage.setItem("coffee_list", JSON.stringify(coffee_list));

            location.reload();

            }

        function print_order_list() {
            var coffee_list = JSON.parse(localStorage.getItem("coffee_list"));
            
            if (coffee_list == null) {
                document.getElementById('coffee-list').innerHTML += `
                    <p id="coffeeNumberP">You haven't added any coffee yet.</p>
                `;
             }

            else {
                document.getElementById('coffee-list').innerHTML += ` <table id="ordertable">
                    <tr>
                        <th>Coffee Name</th>
                        <th>Coffee Size</th>
                        <th>Coffee Quantity</th>
                    </tr>`;

                for (let i = 0; i < coffee_list.length; i++) {
                    document.getElementById('coffee-list').innerHTML += `
                        <table id="ordertable">
                            <tr>
                                <td>${coffee_list[i].coffee_name}</td>
                                <td>${coffee_list[i].coffee_size}</td>
                                <td>${coffee_list[i].coffee_quantity}</td>
                            </tr>
                        </table>  `;
                }

            }

        }
    
        function coffee_options(){
            fetch (`http://127.0.0.1:5000/customer/all-coffees`, 
            {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': 'Bearer ' + localStorage.getItem('customer_token').replace('"', '').replace('"', '')
                }
            })
    
    
            .then(response => response.json())
            .then(data => {
                const coffeeArray = Object.values(data);
                const keys = Object.keys(data);
    
                keys.forEach(key => {
                   document.getElementById('coffee_name').innerHTML += `
                        <option value="${data[key].name}" >${data[key].name}</option>
                    `;
    
                })})

        }

        
        function coffee_amount(){
            const coffee_amount_total = localStorage.getItem('total_order_quantity');
            for (let i = 1; i <= coffee_amount_total; i++) {
                document.getElementById('quantity').innerHTML += `
                        <option value="${i}">${i}</option>
                    `;
            }
            
        }
  
        window.onload = function () {
            var remainCoffeeNumber = localStorage.getItem("total_order_quantity");
            document.getElementById("remain_coffee").innerHTML = "Add " + remainCoffeeNumber + " more coffee(s).";

            coffee_options();
            coffee_amount();
            print_order_list();

        };
    

        function logout() {
            localStorage.removeItem("customer_token");
            localStorage.removeItem("customer_id");
            localStorage.removeItem("total_order_quantity");
            localStorage.removeItem("coffee_list");
            window.location.href = "../index.html";
        }



    </script>


</body>
<footer>
    <p>Copyright © Apollo Coffee 2023

        Pelin Mişe 
    </p>
</footer>
</html>
